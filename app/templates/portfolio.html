{% extends "base.html" %}


{% block header %}<strong id="create-poem">Create Poem</strong>{% endblock %}

{% block content %}
    {% include 'flash.html' %}
    <div id="post-div">
        <div class="well">
            <form class="form-horizontal" action="" method="post" enctype="multipart/form-data" name="post">
                {{ form.hidden_tag() }}
                <div class="control-group{% if form.header.errors %} error{% endif %}">
                    <label class="control-label" for="title">Title</label><br>
                        {{ form.header(size=15) }}
                        {% for error in form.header.errors %}
                            <span class="help-inline">[{{ error }}]</span><br>
                        {% endfor %}
                </div>
                {% if g.user.type == 1 %}
                <div class="control-group{% if form.writing_type.errors %} error{% endif %}">
                    <label class="control-label" for="type">Type</label><br>
                        {{ form.writing_type() }}
                        {% for error in form.writing_type.errors %}
                            <span class="help-inline">[{{ error }}]</span><br>
                        {% endfor %}
                </div>
                {% endif %}
                <div class="control-group{% if form.post.errors %} error{% endif %}">
                    <label class="control-label" for="post">Text</label><br>
                        {{ form.post(id='edit-me') }}
                        {% for error in form.post.errors %}
                            <span class="help-inline">[{{ error }}]</span><br>
                        {% endfor %}
                </div>
                <input class="btn btn-primary" type="submit" value="Post">
            </form>
        </div>
    </div>
    {% for post in posts.items %}
        {% include 'post.html' %}
    {% endfor %}
    {% include 'postie.html' %}
    <script>
    $( document ).ready(function() {
        if($("body").attr("class") != "wysihtml5-supported") {
            if ($('#user-type').html() == 1) {
                $('#edit-me').wysihtml5({
                    toolbar: {
                        "style": true,
                        "font-styles": true,
                        "emphasis": true,
                        "lists": true,
                        "html": true,
                        "link": false,
                        "image": false,
                        "color": false,
                        fa: true
                    }
                });
            } else {
               $('#edit-me').wysihtml5({
                    toolbar: {
                        "style": true,
                        "font-styles": true,
                        "emphasis": true,
                        "lists": true,
                        "html": false,
                        "link": false,
                        "image": false,
                        "color": false,
                        fa: true
                    }
                });
            }
        }

{#        $( "#create-poem" ).click(function() {#}
{#            if ($("#post-div").attr("class") === "hide") {#}
{#                $("#post-div").removeClass('hide');#}
{#                $( "#create-poem" ).html("Cancel");#}
{#            }#}
{#            else {#}
{#                $("#post-div").addClass('hide');#}
{#                $('#create-poem').html("Create New Poem");#}
{#            }#}
{#        });#}

    $( "#create-poem" ).click(function () {
      if ( $( "#post-div" ).is( ":hidden" ) ) {
        $( "#post-div" ).slideDown( "slow" );
        $( "#create-poem" ).html("Cancel");
      } else {
        $( "#post-div" ).hide("slow");
        $('#create-poem').html("Create New Poem");
      }
    });

    });
    </script>
{% endblock %}